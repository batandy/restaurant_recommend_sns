{% load static %}
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
    <title>navermap</title>
    <script type="text/javascript" src="https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=fxqxlpqj6o&submodules=geocoder"></script>
    <link rel="stylesheet" type="text/css" href="{% static 'floating.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'style.css' %}">

</head>
<body>
    <div class="container">
        <div class="icons">
            <a id="log" href="{%url 'main:login' %}">login</a>
        </div>

        <!-- 햄버거 메뉴 -->
        <input type="checkbox" id="trigger" >
        <label for="trigger">
            <!-- 햄버거 세줄 표현 -->
            <span></span>
            <span></span>
            <span></span>
        </label>
        <label for="box"></label>

        <div class="top_space" id="top_space">
            <form id="search_form">
                <input name="search_res" type="text" placeholder="장소, 가게명 검색" required">
            </form>
            
            <div id="weather" style="left:4%;position:fixed;">
                <h3 id="weatherLocate" style="position:fixed; top:5.5vh;"></h3>
                <button id="locateModify" style="position:fixed; top:7.5vh;left:20%;">위치수정</button>
                <img id="weatherIcon" style="position:fixed; top:7.5vh;">
                <h4 id="weatherData" style="position:fixed; top:9.5vh; left:10%;"></h4>
            </div>
            <style>
                input{
                    width: 90%;
                    height: 35px;
                    font-size: 15px;
                    position: relative;
                    top: 2vh;
                    left:4%;
                }
                div.weather{
                    position: relative;
                }
            </style>
        </div>

        <div class="main" id="main">
            <!-- 메인파트내용 -->
            {% block content %}
            {% endblock %}
            <!-- 끝 -->
        </div>

        <div class="map_posi" id="map_posi">
            <div id="map"></div>
        </div>
    </div>

    
    <!-- 자바스크립트 시작 -->
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script type="text/javascript">

        var db = "{{restaurant_db}}";
        var locations = "{{restaurant_db}}".replace(/&quot;/g, '"');
        var test_data=locations
        console.log(locations,test_data)
        for(i in test_data){
            console.log(test_data[i])
        }
        $.ajax({
            url:"{% url 'getdata'%}",
            dataType: "json",
            success: function (data) {
                var apiTest = "";
                console.log(data)
                for (var i = 0; i < data.length; i++) {
                    apiTest += "<tr>"
                    apiTest += "<td>" + data[i].fields.x + "</td>"
                    apiTest += "<td>" + data[i].fields.y + "</td>"
                    apiTest += "<td>" + data[i].fields.name + "</td>"
                    apiTest += "</tr>"
                }
            },
            error: function (request, status, error) {
                console.log('실패');
            }
        });
    </script>
    <script type="text/javascript">


    </script>

    <script src="{% static 'basic.js' %}"></script>
    {% block script %}
    {% endblock %}
    <!-- 자바스크립트 끝 -->
</body>
<table class="json" style="padding:10px">
    <tr>
        <th>name</th>
        <th>x</th>
        <th>y</th>
        <th>ratenum</th>
        <th>ratetext</th>
    </tr>
    {% for restaurant in restaurant_db%}
        <tr>
            <td>{{restaurant.name}}</td>
            <td>{{restaurant.x}}</td>
            <td>{{restaurant.y}}</td>
            <td>{{restaurant.ratenum}}</td>
            <td>{{restaurant.ratetext}}</td>
        </tr>
    {% endfor %}
</table>

</html>
